# Shotgrid ORM Examples

This directory contains example scripts demonstrating various use cases for the Shotgrid ORM Generator.

## Files

### `example_schema.json`
A minimal, sanitized Shotgrid schema file containing four common entity types:
- **Project**: Top-level project entity
- **Sequence**: Shot sequences
- **Shot**: Individual shots with relationships to Project and Sequence
- **Asset**: Assets with relationships to Project and Shots

This schema demonstrates:
- Basic field types (text, number)
- Entity relationships (single entity references)
- Multi-entity relationships (one-to-many)

### `basic_usage.py`
Demonstrates the fundamentals:
- Loading a schema from a JSON file
- Accessing entity classes dynamically
- Generating a standalone Python ORM script

**Run it:**
```bash
cd examples
python basic_usage.py
```

### `create_database.py`
Shows how to create and populate a database:
- Creating a SQLite database from the ORM
- Inserting sample data (Projects, Sequences, Shots, Assets)
- Querying the data using SQLAlchemy

**Run it:**
```bash
cd examples
python create_database.py
```

This creates `example_shotgrid.db` with sample data.

### `live_connection.py`
Demonstrates connecting to a live Shotgrid instance:
- Authenticating with Shotgrid API using script credentials
- Downloading the schema directly from Shotgrid
- Generating an ORM from the live schema

**Requirements:**
Set environment variables before running:
```bash
export SG_URL="https://yourstudio.shotgunstudio.com"
export SG_SCRIPT="your_script_name"
export SG_API_KEY="your_api_key_here"
```

**Run it:**
```bash
cd examples
python live_connection.py
```

## Common Patterns

### Loading from JSON
```python
from shotgrid_orm import SGORM, SchemaType

sg_orm = SGORM(
    sg_schema_type=SchemaType.JSON_FILE,
    sg_schema_source="example_schema.json"
)
```

### Accessing Classes
```python
# Dictionary style
Shot = sg_orm["Shot"]

# Or from classes dict
Shot = sg_orm.classes.get("Shot")
```

### Creating a Database
```python
from sqlalchemy import create_engine

engine = create_engine("sqlite:///mydb.db")
sg_orm.Base.metadata.create_all(engine)
```

### Generating Standalone Script
```python
sg_orm.create_script("sgmodel.py")

# Then in another script:
import sgmodel
Shot = sgmodel.Shot
# or
Shot = sgmodel.CLASSES["Shot"]
```

## Notes

- **Primary Keys**: All IDs are non-auto-increment to preserve Shotgrid's native IDs
- **Foreign Keys**: Not generated by design for maximum flexibility in data transfer
- **Relationships**: Entity fields create `{field}_id` and `{field}_type` columns
- **Multi-entity**: Creates `{field}_ids` (String) and `{field}_type` (String) columns on the source table

## Next Steps

1. Try modifying `example_schema.json` to add custom fields
2. Experiment with different database engines (PostgreSQL, MySQL, etc.)
3. Use Alembic for database migrations
4. Build reporting queries using SQLAlchemy's query API

For more information, see the main [README](../README.md).
